# ============================================================================
# Vehicle Controller Configuration
# ============================================================================
# This file centralizes ALL controller parameters for both longitudinal 
# and lateral control. Change parameters in ONE place for the entire system.
# ============================================================================

# ============================================================================
# GENERAL CONTROL CONFIGURATION
# ============================================================================
enable_steering_control: true  # Enable/disable steering control system

# ============================================================================
# LONGITUDINAL CONTROLLER CONFIGURATION
# ============================================================================

# Controller type options: 'cacc', 'pi', 'hybrid'
longitudinal_controller_type: 'cacc'

# CACC Controller Parameters
cacc:
  s0: 0.8                    # Minimum spacing (meters)
  h: 0.3                     # Time headway (seconds)
  K_spacing: 0.3             # Spacing error gain
  K_velocity: 0.05           # Velocity error gain
  acc_to_throttle_gain: 0.5  # Conversion gain from acceleration to throttle
  max_throttle: 0.3          # Maximum throttle output
  alpha_filter: 0.3          # Low-pass filter coefficient (0-1)
  ki_velocity: 0.1           # Velocity integral gain for additional stability

# PID Velocity Controller Parameters
pid:
  kp: 0.3                    # Proportional gain
  ki: 0.2                    # Integral gain
  kd: 0.0                  # Derivative gain
  max_throttle: 0.1          # Maximum throttle output
  ei_max: 1.0                # Integral anti-windup limit
  v_ref: 0.6                # Default reference velocity (m/s)

# Hybrid Longitudinal Controller Parameters (uses both CACC and PID)
hybrid_longitudinal:
  # Uses CACC when leader available, PID when not
  use_cacc_params: true      # Use params from 'cacc' section
  use_pid_params: true        # Use params from 'pid' section

# ============================================================================
# LATERAL CONTROLLER CONFIGURATION
# ============================================================================

# Controller type options: 'pure_pursuit', 'stanley', 'lookahead', 'hybrid'
lateral_controller_type: 'pure_pursuit'

# Pure Pursuit Controller Parameters
pure_pursuit:
  lookahead_distance: 0.2    # Base lookahead distance (meters)
  k_steering: 0.4            # Proportional steering gain
  max_steering: 0.55         # Maximum steering angle (radians)
  adaptive_lookahead: true   # Enable adaptive lookahead based on distance

# Stanley Controller Parameters
stanley:
  k_e: 0.5                   # Cross-track error gain
  k_soft: 1.0                # Softening gain to prevent division by zero
  max_steering: 0.55         # Maximum steering angle (radians)

# Lookahead Controller Parameters
lookahead:
  ri: 0.8                    # Desired inter-vehicle spacing (meters)
  hi: 0.3                    # Time headway (seconds)
  l_r: 0.141                 # Distance from CG to rear axle (meters)
  l_f: 0.115                 # Distance from CG to front axle (meters)
  k1: 1.0                    # Lateral control gain
  k2: 1.0                    # Yaw rate control gain
  max_steering: 0.55         # Maximum steering angle (radians)

# Hybrid Lateral Controller Parameters
hybrid_lateral:
  primary_controller: 'pure_pursuit'   # Controller to use when close (see pure_pursuit params)
  secondary_controller: 'stanley'      # Controller to use when far (see stanley params)
  switch_distance: 1.5                 # Distance threshold for switching (meters)
  use_primary_params: true             # Use params from primary controller section
  use_secondary_params: true           # Use params from secondary controller section

# ============================================================================
# VEHICLE PARAMETERS (for all controllers)
# ============================================================================
vehicle:
  wheelbase: 0.256           # Total wheelbase (l_r + l_f) in meters
  l_r: 0.141                 # Distance from CG to rear axle (meters)
  l_f: 0.115                 # Distance from CG to front axle (meters)

# ============================================================================
# QUICK SWITCH PRESETS
# ============================================================================
# Uncomment the sections you want to use:

# ------------------------------------------------------------------------
# Preset 1: Aggressive Following (Tight spacing, responsive)
# ------------------------------------------------------------------------
# longitudinal_controller_type: 'cacc'
# lateral_controller_type: 'pure_pursuit'
# cacc:
#   s0: 1.0
#   h: 0.3
#   K_spacing: 0.3
#   K_velocity: 0.08
# pure_pursuit:
#   lookahead_distance: 0.8
#   k_steering: 1.2

# ------------------------------------------------------------------------
# Preset 2: Conservative/Safe Following (Large spacing, smooth)
# ------------------------------------------------------------------------
# longitudinal_controller_type: 'cacc'
# lateral_controller_type: 'stanley'
# cacc:
#   s0: 2.0
#   h: 0.7
#   K_spacing: 0.15
#   K_velocity: 0.03
# stanley:
#   k_e: 0.3
#   k_soft: 1.5

# ------------------------------------------------------------------------
# Preset 3: Simple Velocity Tracking (No spacing control)
# ------------------------------------------------------------------------
# longitudinal_controller_type: 'pi'
# lateral_controller_type: 'pure_pursuit'

# ------------------------------------------------------------------------
# Preset 4: Best of Both Worlds (Adaptive hybrid controllers)
# ------------------------------------------------------------------------
# longitudinal_controller_type: 'hybrid'
# lateral_controller_type: 'hybrid'

# ------------------------------------------------------------------------
# Preset 5: Advanced Lookahead Control
# ------------------------------------------------------------------------
# longitudinal_controller_type: 'cacc'
# lateral_controller_type: 'lookahead'
# lookahead:
#   k1: 1.2
#   k2: 1.0
#   ri: 1.5
